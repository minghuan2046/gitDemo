# 复制分类

1. 基于行的复制（RBR）:

2. 基于语句的复制(SBR):

# 零散知识
- 删除日志 RESET MASTER ， PURGE BINARY LOGS


- 二进制日志按在master提交顺序记录事务，事务的顺序取决于提交时间

- 在语句提交的同时将语句写进二进制日志

- 在运行时更改二进制日志格式会导致异常的情况：
 - 在存储过程或者触发器中
 - 在NDB存储引擎被使用时
 - 如果会话当前处于基于行的复制模式并且已打开临时表



- 触发器的定义者和调用者权限?



### 二进制文件中包含一系列事件，每个事件有一个固定的头部（19字节），包含事件的时间和日期，原服务器id，下一个事件的偏移字节，事件类型，执行时长，错误码。

```180725 14:15:13 server id 174855174  end_log_pos 1235 	Query	thread_id=1413	exec_time=0	error_code=0```


### 二进制日志记录时机
- 非事务存储引擎在记录二进制日志之前完成了所有更改。
- 事务性存储引擎在事务释放表上的锁之前，在所有修改已经发送到事物引擎之后写二进制日志。


### mysql变量
日志：
- log-bin：记录二进制日志
- log-bin-index:日志索引文件的名字
- sql_log_bin：拥有超级权限的账户可以设置值为0，不记录自己的语句到binlog中
- binlog_checksum：为事件计算指纹。
- log-slave-updates ：从节点开启这个参数也会记录日志

- binlog_cache_size：事务开启时，日志将会被缓存，超过这个值的限制将会新建一个临时文件去记录事务。
- innodb_support_xa:设置为1可防止Innodb和二进制日志未完全同步，这种发生在日志中记录了时间，commit时崩溃。
- sync-binlog:binlog刷盘的时机
- binlog-cache-size：控制binlog文件的尺寸，当大事务日志超过这个文件大小，这个事务日志不会跨文件，而是在这个日志中全部记载，也就是日志文件大小会超过这个限制。
- expire-logs-days:自动清理旧的binlog文件
- log_slave_update:从库设置该变量后也会记录日志
